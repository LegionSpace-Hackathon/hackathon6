#!/usr/bin/env python3
"""
ç®€å•çš„MCPæµ‹è¯•æœåŠ¡
åŠŸèƒ½ï¼šæä¾›ä¸€ä¸ªè‡ªå®šä¹‰è¿åŠ¿è®¡ç®—å·¥å…·
ç«¯å£ï¼š8001
"""
 
from mcp.server.fastmcp import FastMCP
 
# åˆ›å»ºMCPæœåŠ¡å™¨
mcp = FastMCP("simple-test-server", port=8001, host="0.0.0.0")
 
@mcp.tool()
async def number_fortune_teller(x: float, y: float) -> str:
    """
    æ•°å­—å åœå¸ˆ - æ ¹æ®ä¸¤ä¸ªç¥ç§˜æ•°å­—é¢„æµ‹ä½ çš„è¿åŠ¿
    
    å‚æ•°ï¼š
        - **x**: ç¬¬ä¸€ä¸ªç¥ç§˜æ•°å­—
        - **y**: ç¬¬äºŒä¸ªç¥ç§˜æ•°å­—
    
    è¿”å›ï¼š
        str: åŸºäºæ•°å­—çš„ç¥ç§˜é¢„æµ‹ç»“æœ
    """
    # è®¡ç®—ç¥ç§˜æŒ‡æ•°
    magic_number = abs(int((x + y) * 7.777)) % 1000
    
    # å¹¸è¿åŠ¨ç‰©é¢„æµ‹
    animals = ["ğŸ‰é¾™", "ğŸ¦„ç‹¬è§’å…½", "ğŸ§ä¼é¹…", "ğŸ¦‹è´è¶", "ğŸ™ç« é±¼", "ğŸ¦©ç«çƒˆé¸Ÿ", "ğŸ¨è€ƒæ‹‰", "ğŸ¦”åˆºçŒ¬"]
    lucky_animal = animals[magic_number % len(animals)]
    
    # ä»Šæ—¥è¿åŠ¿
    fortunes = [
        "ä»Šå¤©ä¼šé‡åˆ°æ„æƒ³ä¸åˆ°çš„æƒŠå–œï¼", 
        "å°å¿ƒï¼ä»Šå¤©å¯èƒ½ä¼šæ‰è¿›å…”å­æ´", 
        "ä»Šå¤©ç‰¹åˆ«é€‚åˆå­¦ä¹ æ–°æŠ€èƒ½",
        "ä¼šæ”¶åˆ°æ¥è‡ªè¿œæ–¹çš„ç¥ç§˜æ¶ˆæ¯",
        "ä»Šå¤©çš„å’–å•¡ä¼šæ ¼å¤–é¦™é†‡",
        "å¯èƒ½ä¼šé‡åˆ°ä¼šè¯´è¯çš„çŒ«",
        "ä»Šå¤©é€‚åˆç©¿äº®è‰²è¡£æœ",
        "ä¼šå‘ç°éšè—çš„å®è—ï¼ˆå¯èƒ½æ˜¯è¢œå­ï¼‰"
    ]
    today_fortune = fortunes[magic_number % len(fortunes)]
    
    # å¹¸è¿æ•°å­—
    lucky_num = (magic_number * 3 + 42) % 100
    
    # å¥‡æ€ªçš„å»ºè®®
    advice = [
        "å¤šåƒç´«è‰²çš„é£Ÿç‰©", "å€’ç€èµ°7æ­¥", "å¯¹é•œå­çœ¨çœ¼3æ¬¡", 
        "ç»™æ¤ç‰©å”±æ­Œ", "ç”¨å·¦æ‰‹åˆ·ç‰™", "æ•°ä¸€æ•°å¤©ç©ºä¸­çš„äº‘æœµ",
        "å‘è·¯è¿‡çš„ç‹—ç‹—é—®å¥½", "åœ¨11:11è®¸ä¸ªæ„¿"
    ]
    weird_advice = advice[magic_number % len(advice)]
    
    result = f"""
ğŸ”® æ•°å­—å åœç»“æœ ğŸ”®
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š è¾“å…¥æ•°å­—: {x} å’Œ {y}
âœ¨ ç¥ç§˜æŒ‡æ•°: {magic_number}
ğŸ€ å¹¸è¿åŠ¨ç‰©: {lucky_animal}
ğŸŒŸ ä»Šæ—¥è¿åŠ¿: {today_fortune}
ğŸ¯ å¹¸è¿æ•°å­—: {lucky_num}
ğŸ’¡ ç¥ç§˜å»ºè®®: {weird_advice}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸  æ­¤é¢„æµ‹ä»…ä¾›å¨±ä¹ï¼Œè¯·å‹¿å½“çœŸ âš ï¸
"""
    return result
 
if __name__ == "__main__":
    print("å¯åŠ¨ç®€å•MCPæµ‹è¯•æœåŠ¡...")
    print("æœåŠ¡å™¨åœ°å€: http://0.0.0.0:8001")
    print("SSEç«¯ç‚¹: http://localhost:8001/sse")
    print("ä½¿ç”¨æœ¬åœ°dockerå¯åŠ¨çš„difyä½¿ç”¨ï¼šSSEç«¯ç‚¹: http://host.docker.internal:8001/sse")
    print("å¯ç”¨å·¥å…·:")
    print("- number_fortune_teller: æ•°å­—å åœå¸ˆ(æ ¹æ®æ•°å­—é¢„æµ‹è¿åŠ¿)")
    mcp.run(transport="sse") 